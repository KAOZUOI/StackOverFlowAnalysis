    Properties props = new Properties();    props.put(&quot;mail.store.protocol&quot;, &quot;imap&quot;);    props.put(&quot;mail.imap.host&quot;, &quot;outlook.office365.com&quot;);    props.put(&quot;mail.imap.port&quot;, &quot;993&quot;);    props.put(&quot;mail.imap.ssl.enable&quot;, &quot;true&quot;);    props.put(&quot;mail.imap.starttls.enable&quot;, &quot;true&quot;);    props.put(&quot;mail.imap.auth&quot;, &quot;true&quot;);    props.put(&quot;mail.imap.auth.mechanisms&quot;, &quot;XOAUTH2&quot;);    props.put(&quot;mail.imap.user&quot;, mailAddress);    props.put(&quot;mail.debug&quot;, &quot;true&quot;);    props.put(&quot;mail.debug.auth&quot;, &quot;true&quot;);    // open mailbox....    String token = getAuthToken(tanantId,clientId,client_secret);    Session session = Session.getInstance(props);    session.setDebug(true);    Store store = session.getStore(&quot;imap&quot;);    store.connect(&quot;outlook.office365.com&quot;, mailAddress, token);