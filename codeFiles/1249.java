        // save workbook to file:        val fileName = &quot;data_$formattedDate.xlsx&quot;        val fos: FileOutputStream =            activity.openFileOutput(fileName, Context.MODE_PRIVATE)!!        workbook.write(fos)        workbook.close()        withContext(Dispatchers.IO) {            fos.flush()            fos.close();        };        //need: fos.path, but it is private!        val appPath = activity.application?.filesDir?.absolutePath        // delete old .xlsx files        val dir = appPath?.let { File(it) }        dir?.listFiles()!!.forEach { file ->            run {                if (file.name.endsWith(&quot;.xlsx&quot;)) {                    file.deleteOnExit()                }            }        }        val exportFile = File(appPath, fileName)        val sharingIntent = Intent(Intent.ACTION_SEND)        val fileUri =            FileProvider.getUriForFile(//                activity.applicationContext!!,                activity.packageName + &quot;.fileProvider&quot;,                exportFile            );