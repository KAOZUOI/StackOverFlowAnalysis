AggregateIterable<Document> output = collection.aggregate(Arrays.asList(                match(new Document(&quot;projectKey&quot;, &quot;myProject&quot;)),                new Document(&quot;$group&quot;, new Document(&quot;_id&quot;, &quot;$Key&quot;)                        .append(&quot;maxQuantity&quot;, new Document(&quot;$max&quot;, &quot;$highestIndex&quot;))                        .append(&quot;docs&quot;, new Document(&quot;$push&quot;, new Document(&quot;_id&quot;, &quot;$_id&quot;).append(&quot;Key&quot;, &quot;$Key&quot;)                                .append(&quot;highestIndex&quot;, &quot;$highestIndex&quot;).append(&quot;exists&quot;, &quot;$exists&quot;).append(&quot;type&quot;, &quot;$type&quot;)))),                new Document(&quot;$project&quot;,                        new Document(&quot;_id&quot;, 0L).append(&quot;docs&quot;,                                new Document(&quot;$filter&quot;, new Document(&quot;input&quot;, &quot;$docs&quot;).append(&quot;as&quot;, &quot;doc&quot;).append(                                        &quot;cond&quot;,                                        new Document(&quot;$eq&quot;, Arrays.asList(&quot;$$doc.highestIndex&quot;, &quot;$maxQuantity&quot;))))))));Iterator<Document> iterator = output.iterator();    while (iterator.hasNext()) {        System.out.println(iterator.next().get(&quot;docs&quot;));    }